<!DOCTYPE html>
<html>
<head>
    <title>Test Mini App</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Test Mini App</h1>
    <button id="testButton">Send Test Data</button>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        console.log("JavaScript начал выполняться.");

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded event fired');

             function initializeWebApp() {
                 if (window.Telegram && window.Telegram.WebApp) {
                     console.log("Telegram WebApp API ready.");
                     const tg = window.Telegram.WebApp;
                     tg.ready();

                     const testButton = document.getElementById('testButton');
                     console.log("Кнопка найдена:", testButton);

                     if (testButton) {
                         testButton.addEventListener('click', function() {
                              console.log("Кнопка нажата.");
                             tg.MainButton.text = 'Отправка...';
                             tg.MainButton.show();
                             setTimeout(() => {
                                  tg.sendData('test_data');
                                   console.log('Данные отправлены: test_data');
                                 }, 500);
                         });
                    } else {
                         console.error("Ошибка: Кнопка не найдена");
                    }
                }
              else{
                   console.log("Telegram WebApp not ready yet, retrying in 100ms");
                setTimeout(initializeWebApp, 100);
                 }
             }
              initializeWebApp();
        });

    </script>
</body>
</html>
